#STAGE 2. Annotating protein domains in peptide sequences

**Requirements** 
 
interproscan (https://www.ebi.ac.uk/interpro/interproscan.html)  
hmmsearch (http://hmmer.org/)

**Datasets**  

a) data/sucy_database_uniprot.fasta    
b) data/GENOMES_NCBI_nr_24042014.faa  -> non-redundant proteomes (heavy file, not provided; see Stage1)
c) hidden markov models *.hmm     
 	
1. Annotate PFAM domains in non-redundant proteomes. Optionally Superfamily and TIGRFAM domains could also be annotated:

$ interproscan-5.4-47.0/bin/superfamily/1.75/ass3.pl GENOMES_NCBI_nr_24042014.faa \
  GENOMES_NCBI_nr_24042014.sf.tab GENOMES_NCBI_nr_24042014.sf \
  -s interproscan-5.4-47.0/data/superfamily/1.75/self_hits.tab \
  -r interproscan-5.4-47.0/data/superfamily/1.75/dir.cla.scop.txt_1.75 |
  -m interproscan-5.4-47.0/data/superfamily/1.75/model.tab \ 
  -p interproscan-5.4-47.0/data/superfamily/1.75/pdbj95d \
  -f 12

2. Output should look like this:      

Q54506    6cbba7cb557879dfe57c62e4e0c8bfe1    437    TIGRFAM    TIGR00339    sopT: sulfate adenylyltransferase    4    386    3.4E-141    T    10-07-2014    IPR002650    Sulphate adenylyltransferase    KEGG: 00230+2.7.7.4|KEGG: 00450+2.7.7.4|KEGG: 00920+2.7.7.4|MetaCyc: PWY-5278|MetaCyc: PWY-5340|MetaCyc: PWY-6683|MetaCyc: PWY-6932|Reactome: REACT_13433|UniPathway: UPA00140

3. From the output file we are interested in the PFAMs ids, copy third and fourht column in a new file *.txt   

4. With script extract_hmms.pl, we generate the database that contains the hidden markov models of each family.   
   
$ perl extract_hmms.pl

5. This will generate an output file named 'my_Pfam.hmm'. Note that Superfamily and TIGRFAM HMMs can also be used, but are commented out.

6. Annotate PFAM domains in non-redundant proteomes:   

$ hmmsearch --cut_ga --tblout file.tab /pfam_metagenomes/datasets/myPfam.hmm  GENOMAS_NCBI_nr_24042014.faa

#Relative entropy  

**Requirements**

1) hmmsearch output tabular format: file.tab  
2) curated list of genomes of metabolism of interest: nr_sucy.txt

$ perl  matrix.pl *.tab nr_sucy.txt > matrix.csv


